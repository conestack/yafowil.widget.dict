var another_bundle=function(e,t){"use strict";class i{constructor(e){e.data("yafowil-dict",this),this.elem=e;let i=t("> thead .dict_actions",e),a=this.add_first_handle.bind(this);t("a.dict_row_add",i).off().on("click",a),this.bind_actions()}bind_actions(){let e=t("> tbody > tr > td.actions .dict_actions",this.elem),i=this.add_handle.bind(this),a=this.remove_handle.bind(this),r=this.up_handle.bind(this),s=this.down_handle.bind(this);this.mark_disabled(e),t("a.dict_row_add",e).off().on("click",i),t("a.dict_row_remove",e).off().on("click",a),t("a.dict_row_up",e).off().on("click",r),t("a.dict_row_down",e).off().on("click",s)}mark_disabled(e){t("a.dict_row_up",e).removeClass("dict_row_up_disabled").first().addClass("dict_row_up_disabled"),t("a.dict_row_down",e).removeClass("dict_row_down_disabled").last().addClass("dict_row_down_disabled")}row_class(e,t){for(let e of this.elem.attr("class").split(" "))if(e.substring(0,t.length)==t)return e.substring(t.length+1,e.length);return""}create_row(e){}get_row(e){return t(e).parent().parent().parent()}get base_name(){let e=this.elem.attr("id");return e.substring(11,e.length)}reset_indices(e){var i=0,a=this.base_name,r=a.replace(/\./g,"-");t("tr",e).each((function(){let e=t(this),s=t("td.key input",e),n=r+i+"-key",d=a+i+".key";s.attr("id",n).attr("name",d);let o=t("td.value input",e),l=r+i+"-value",c=a+i+".value";o.attr("id",l).attr("name",c),i++})),this.bind_actions()}add_first_handle(e){e.preventDefault();let i=this.create_row(e.currentTarget),a=t("> tbody",this.elem);a.prepend(i),this.reset_indices(a)}add_handle(e){e.preventDefault();let t=e.currentTarget,i=this.get_row(t),a=this.create_row(t),r=i.parent();i.after(a),this.reset_indices(r)}remove_handle(e){e.preventDefault();let t=this.get_row(e.currentTarget),i=t.parent();t.remove(),this.reset_indices(i)}up_handle(e){e.preventDefault();let t=this.get_row(e.currentTarget);t.insertBefore(t.prev()),this.reset_indices(t.parent())}down_handle(e){e.preventDefault();let t=this.get_row(e.currentTarget);t.insertAfter(t.next()),this.reset_indices(t.parent())}}class a extends i{static initialize(e){t("table.dictwidget",e).each((function(){let e=t(this);void 0!==window.yafowil_array&&window.yafowil_array.inside_template(e)||new a(e)}))}create_row(e){let t="";return t+="<tr>",t+='<td class="key">',t+='<input type="text" class="'+this.row_class(e,"key")+'" value="" />',t+="</td>",t+='<td class="value">',t+='<input type="text" class="'+this.row_class(e,"value")+'" value="" />',t+="</td>",t+='<td class="actions">',t+='<div class="dict_actions">',t+='<a class="dict_row_add" href="#">',t+='<span class="bi-plus-circle-fill"> </span>',t+="</a>",t+='<a class="dict_row_remove" href="#">',t+='<span class="bi-dash-circle-fill"> </span>',t+="</a>",t+='<a class="dict_row_up" href="#">',t+='<span class="bi-arrow-up-circle-fill"> </span>',t+="</a>",t+='<a class="dict_row_down" href="#">',t+='<span class="bi-arrow-down-circle-fill"> </span>',t+="</a>",t+="</div>",t+="</td>",t+="</tr>",t}on_row_moved(e){e.addClass("row-moved"),setTimeout((function(){e.removeClass("row-moved")}),1e3)}up_handle(e){e.preventDefault();let t=this.get_row(e.currentTarget);t.insertBefore(t.prev()),this.reset_indices(t.parent()),this.on_row_moved(t)}down_handle(e){e.preventDefault();let t=this.get_row(e.currentTarget);t.insertAfter(t.next()),this.reset_indices(t.parent()),this.on_row_moved(t)}}function r(e,t){a.initialize(t)}function s(){void 0!==window.yafowil_array?window.yafowil_array.on_array_event("on_add",r):void 0!==yafowil.array&&t.extend(yafowil.array.hooks.add,{dictwidget_binder:a.initialize})}return t((function(){void 0!==window.ts?ts.ajax.register(a.initialize,!0):void 0!==window.bdajax?bdajax.register(a.initialize,!0):a.initialize(),s()})),e.DictWidget=a,e.register_array_subscribers=s,Object.defineProperty(e,"__esModule",{value:!0}),window.yafowil=window.yafowil||{},window.yafowil.dict=e,e}({},jQuery);
